!function(e,t){"function"==typeof define&&define.amd?define(["DP"],t):e.DP=t(e.DP)}(this,function(e){"use strict";return e=function(e,t){var n=this;if(n.store={},n.settings={},n.container=e,"undefined"==typeof t||"undefined"==typeof t.data)n.unit=n.container.getElementsByClassName("dp-unit")[0],n.span=n.container.getElementsByClassName("dp-span")[0],n.menu=n.container.getElementsByClassName("dp-menu")[0];else if(n.settings.valueReturnByFunction=t.valueReturnByFunction||!0,n.data=t.data,Array.isArray(n.data)){n.container.innerHTML="",n.container.classList.add("dp-container"),n.unit=document.createElement("div"),n.unit.classList.add("dp-unit"),n.container.appendChild(n.unit),n.span=document.createElement("div"),n.span.classList.add("dp-span"),n.span.textContent=t.name,n.unit.appendChild(n.span),n.menu=document.createElement("ul"),n.menu.classList.add("dp-menu"),n.unit.appendChild(n.menu);var s;n.data.map(function(e,t){s=document.createElement("li"),s.classList.add("dp-item"),s.textContent=e.label,s.dataset.index=t,n.menu.appendChild(s)})}else console.error("Unsupported data type");return document.addEventListener("click",function(e){n.menu.classList.contains("open")&&!n.isDescendant(n.container,e.target)&&n.menu.classList.remove("open")}),n.span.addEventListener("click",function(){n.menu.classList.toggle("open")}),n.menu.addEventListener("click",function(e){if(e.target.classList.contains("dp-item")){var t=parseInt(e.target.dataset.index,10);t>-1?n.setValueIndex(t):n.setValue(e.target.dataset.value),n.close()}}),this},e.prototype.listen=function(e,t){this._events=this._events||{},this._events[e]=this._events[e]||[],this._events[e].push(t)},e.prototype.unlisten=function(e,t){this._events=this._events||{},e in this._events!=!1&&this._events[e].splice(this._events[e].indexOf(t),1)},e.prototype.trigger=function(e){if(this._events=this._events||{},e in this._events!=!1)for(var t=0;t<this._events[e].length;t++)this._events[e][t].apply(this,[this.getValue(),Array.prototype.slice.call(arguments,1)])},e.prototype.getValue=function(){var e,t;return t=parseInt(this.store.currentIndex,10),t>-1?(e=this.data[t].value,"function"==typeof e&&(e=e())):e=this.store.value,e},e.prototype.setValue=function(e){return this.store.currentIndex=null,this.store.value=e,this.trigger("changeValue"),!0},e.prototype.setValueIndex=function(e){this.store.value=null,this.store.currentIndex=e,this.trigger("changeValue")},e.prototype.open=function(){this.menu.classList.add("open")},e.prototype.close=function(){this.menu.classList.remove("open")},e.prototype.isDescendant=function(e,t){for(var n=t.parentNode;null!=n;){if(n==e)return!0;n=n.parentNode}return!1},e});